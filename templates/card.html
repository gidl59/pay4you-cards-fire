{% extends "base.html" %}

{% block title %}{{ ag.name }}{% endblock %}

{% block content %}
<div class="card-fullscreen">
  <div class="card-glass-bg"></div>

  <div class="card-outer">
    <!-- HEADER LOGO -->
    <div class="card-header-row">
      <img src="{{ url_for('static', filename='logo.png') }}"
           alt="Pay4You"
           class="card-logo-big">
    </div>

    <!-- BLOCCO FOTO + DATI -->
    <div class="business-card">
      {% if ag.photo_url %}
      <div class="card-profile-photo-wrapper">
        <img src="{{ ag.photo_url }}"
             alt="{{ ag.name }}"
             class="card-profile-photo">
      </div>
      {% endif %}

      <div class="card-name-block">
        <h1 class="card-name">{{ ag.name }}</h1>

        {% if ag.role %}
          <div class="card-role-main">{{ ag.role }}</div>
        {% endif %}

        {% if ag.company %}
          <div class="card-role-sub">{{ ag.company }}</div>
        {% endif %}

        {% if ag.bio %}
          <div class="card-bio">{{ ag.bio }}</div>
        {% endif %}
      </div>
    </div>

    <!-- CONTATTI -->
    <section class="card-section">
      <h2>Contatti</h2>

      {% if ag.phone_mobile %}
      <a class="contact-row" href="tel:{{ ag.phone_mobile }}">
        <span class="icon">ğŸ“±</span>
        <span class="label">Chiama mobile</span>
        <span class="value">{{ ag.phone_mobile }}</span>
      </a>
      {% endif %}

      {% if ag.phone_office %}
      <a class="contact-row" href="tel:{{ ag.phone_office }}">
        <span class="icon">â˜ï¸</span>
        <span class="label">Chiama ufficio</span>
        <span class="value">{{ ag.phone_office }}</span>
      </a>
      {% endif %}

      {% if ag.whatsapp %}
      <a class="contact-row whatsapp-row"
         href="https://wa.me/{{ ag.whatsapp|replace('+','') }}"
         target="_blank">
        <span class="icon">ğŸŸ¢</span>
        <span class="label">WhatsApp</span>
        <span class="value">{{ ag.whatsapp }}</span>
      </a>
      {% endif %}

      {% if emails and emails|length > 0 %}
      <a class="contact-row" href="mailto:{{ emails[0] }}">
        <span class="icon">âœ‰ï¸</span>
        <span class="label">Email</span>
        <span class="value">{{ emails[0] }}</span>
      </a>
      {% endif %}

      {% if emails and emails|length > 1 %}
      <a class="contact-row" href="mailto:{{ emails[1] }}">
        <span class="icon">âœ‰ï¸</span>
        <span class="label">Email</span>
        <span class="value">{{ emails[1] }}</span>
      </a>
      {% endif %}

      {% if ag.pec %}
      <a class="contact-row" href="mailto:{{ ag.pec }}">
        <span class="icon">ğŸ“®</span>
        <span class="label">PEC</span>
        <span class="value">{{ ag.pec }}</span>
      </a>
      {% endif %}

      {% if websites and websites|length > 0 %}
      <a class="contact-row"
         href="{{ url_for('site_view', slug=ag.slug|lower, index=0) }}">
        <span class="icon">ğŸŒ</span>
        <span class="label">Sito internet</span>
        <span class="value">{{ websites[0] }}</span>
      </a>
      {% endif %}

      {% if ag.facebook %}
      <a class="contact-row social-row" href="{{ ag.facebook }}" target="_blank">
        <span class="icon">ğŸ“˜</span>
        <span class="label">Facebook</span>
        <span class="value">Profilo</span>
      </a>
      {% endif %}

      {% if ag.instagram %}
      <a class="contact-row social-row" href="{{ ag.instagram }}" target="_blank">
        <span class="icon">ğŸ“¸</span>
        <span class="label">Instagram</span>
        <span class="value">Profilo</span>
      </a>
      {% endif %}

      {% if ag.linkedin %}
      <a class="contact-row social-row" href="{{ ag.linkedin }}" target="_blank">
        <span class="icon">ğŸ’¼</span>
        <span class="label">LinkedIn</span>
        <span class="value">Profilo</span>
      </a>
      {% endif %}

      <!-- SALVA CONTATTO -->
      <a class="contact-row" href="{{ url_for('vcard', slug=ag.slug|lower) }}?download=1">
        <span class="icon">ğŸ’¾</span>
        <span class="label">Salva contatto</span>
        <span class="value">Scarica vCard</span>
      </a>

      <!-- QR -->
      <a class="contact-row" href="{{ url_for('qr', slug=ag.slug|lower) }}" target="_blank">
        <span class="icon">ğŸ”²</span>
        <span class="label">QR code</span>
        <span class="value">Apri QR</span>
      </a>
    </section>

    <!-- DATI FISCALI -->
    {% if ag.piva or ag.sdi %}
    <section class="card-section">
      <h2>Dati fiscali</h2>

      {% if ag.piva %}
      <div class="contact-row">
        <span class="icon">ğŸ›ï¸</span>
        <span class="label">Partita IVA</span>
        <span class="value">{{ ag.piva }}</span>
      </div>
      {% endif %}

      {% if ag.sdi %}
      <div class="contact-row">
        <span class="icon">ğŸ§¾</span>
        <span class="label">Codice SDI</span>
        <span class="value">{{ ag.sdi }}</span>
      </div>
      {% endif %}
    </section>
    {% endif %}

    <!-- INDIRIZZI -->
    {% if addresses and addresses|length > 0 %}
    <section class="card-section">
      <h2>Indirizzi</h2>
      {% for a in addresses %}
      <div class="address-row">
        <div class="address-value">{{ a }}</div>
      </div>
      {% endfor %}
    </section>
    {% endif %}

    <!-- DOCUMENTI PDF -->
    {% if pdf_urls and pdf_urls|length > 0 %}
    <section class="card-section">
      <h2>Documenti</h2>
      <div class="pdf-list">
        {% for idx, url in pdf_urls %}
        <a class="pdf-item"
           href="{{ url_for('pdf_view', slug=ag.slug|lower, index=idx) }}">
          <span class="pdf-icon">ğŸ“„</span>
          <span>Documento {{ loop.index }}</span>
        </a>
        {% endfor %}
      </div>
    </section>
    {% endif %}

    <!-- GALLERIA FOTO -->
    {% if gallery and gallery|length > 0 %}
    <section class="card-section">
      <h2>Galleria foto</h2>
      <div class="gallery-scroll">
        {% for img in gallery %}
        <a href="{{ img }}" target="_blank">
          <img src="{{ img }}" alt="Foto {{ loop.index }}">
        </a>
        {% endfor %}
      </div>
    </section>
    {% endif %}

  </div>
</div>
{% endblock %}
