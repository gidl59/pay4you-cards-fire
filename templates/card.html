<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ ag.name }} | Pay4You</title>
  <link rel="stylesheet" href="/static/card.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body data-theme="auto">

  <div class="card-wrap">
    
    <div class="hero">
        {% if ag.logo_url %}
            <img src="{{ ag.logo_url }}" class="hero-logo-circle {% if ag.fx_rotate_logo=='on' %}spin-cw{% endif %}">
        {% endif %}
    </div>

    <div class="avatar-container">
        {% if ag.photo_url %}
            <img src="{{ ag.photo_url }}" class="avatar-img {% if ag.fx_rotate_agent=='on' %}spin-cw{% endif %}">
        {% else %}
            <div class="avatar-img" style="display:flex;align-items:center;justify-content:center;font-size:40px;">üë§</div>
        {% endif %}
    </div>

    <div class="info-section">
        <h1 style="margin-bottom:5px;">{{ ag.name }}</h1>
        <div style="opacity:0.8; margin-bottom:15px;" id="role-txt">{{ ag.role }}</div>
        
        {% if ag.company %}
        <div class="box-company">
            <small style="color:var(--brand); font-weight:bold;">AZIENDA</small><br>
            <span style="font-size:18px; font-weight:bold;">{{ ag.company }}</span>
        </div>
        {% endif %}

        {% if ag.bio %}
        <div class="box-bio" id="bio-txt">{{ ag.bio }}</div>
        {% endif %}
    </div>

    <div style="display:flex; gap:10px; justify-content:center; align-items:center; margin-bottom:20px;">
        <a href="/vcf/{{ ag.slug }}" class="btn-save" style="background:var(--brand-grad); color:black; padding:12px 30px; border-radius:30px; text-decoration:none; font-weight:bold;">SALVA CONTATTO</a>
        
        <div class="btn-qr-mini" onclick="openQrModal()">
            <img src="https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=https://pay4you-cards-fire.onrender.com/card/{{ ag.slug }}">
        </div>
    </div>

    <div class="social-grid">
        {% for s in socials %}
        <a href="{{ s.url }}" target="_blank" class="soc-btn 
           {% if 'Facebook' in s.label %}soc-fb{% elif 'Instagram' in s.label %}soc-ig{% elif 'Linkedin' in s.label %}soc-li{% elif 'TikTok' in s.label %}soc-tk{% elif 'Spotify' in s.label %}soc-sp{% elif 'Telegram' in s.label %}soc-tg{% elif 'YouTube' in s.label %}soc-yt{% endif %}">
           <i class="fab fa-{{ s.label|lower if s.label!='TikTok' else 'tiktok' }}"></i>
        </a>
        {% endfor %}
    </div>

    <div style="text-align:left; padding:0 20px;">
        {% for m in mobiles %}<div style="padding:10px; border-bottom:1px solid #eee;">üìû <a href="tel:{{m}}">{{m}}</a></div>{% endfor %}
        {% if ag.office_phone %}<div style="padding:10px; border-bottom:1px solid #eee;">‚òéÔ∏è Ufficio: <a href="tel:{{ag.office_phone}}">{{ag.office_phone}}</a></div>{% endif %}
        {% for e in emails %}<div style="padding:10px; border-bottom:1px solid #eee;">‚úâÔ∏è <a href="mailto:{{e}}">{{e}}</a></div>{% endfor %}
        {% for w in websites %}<div style="padding:10px; border-bottom:1px solid #eee;">üåê <a href="{{w}}" target="_blank">{{w}}</a></div>{% endfor %}
        
        <div style="margin-top:20px; font-size:12px; opacity:0.7;">
            {% if ag.piva %}<div>P.IVA: {{ ag.piva }}</div>{% endif %}
            {% if ag.cod_sdi %}<div>SDI: {{ ag.cod_sdi }}</div>{% endif %}
            {% if ag.pec %}<div>PEC: {{ ag.pec }}</div>{% endif %}
        </div>
    </div>

    <div class="switcher-bar">
        <div>
            {% if p2_enabled and profile != 'p2' %}<a href="?p=p2" class="sw-link">VAI AL P2</a>{% endif %}
            {% if p3_enabled and profile != 'p3' %}<a href="?p=p3" class="sw-link">VAI AL P3</a>{% endif %}
            {% if profile != 'p1' %}<a href="?p=p1" class="sw-link">VAI AL P1</a>{% endif %}
        </div>
        <div>
            <span onclick="setTheme('light')" class="sw-link" style="cursor:pointer;">CHIARO</span>
            <span onclick="setTheme('dark')" class="sw-link" style="cursor:pointer;">SCURO</span>
            <span onclick="setTheme('auto')" class="sw-link" style="cursor:pointer;">AUTO</span>
        </div>
    </div>

    <div style="padding:0 20px; text-align:left;">
        {% if p_data.gallery_img %}
        <h4>FOTO</h4>
        <div class="gal-grid">
            {% for img in p_data.gallery_img %}<img src="{{ img }}" class="gal-item" onclick="openImg('{{ img }}')">{% endfor %}
        </div>
        {% endif %}

        {% if p_data.gallery_vid %}
        <h4>VIDEO</h4>
        <div class="video-list" style="text-align:center;">
            {% for vid in p_data.gallery_vid %}
            <video controls><source src="{{ vid }}"></video>
            {% endfor %}
        </div>
        {% endif %}
        
        {% if p_data.gallery_pdf %}
        <h4>DOC</h4>
        {% for pdf in p_data.gallery_pdf %}
            <a href="{{ pdf.path }}" target="_blank" style="display:block; padding:10px; background:#f9f9f9; border-radius:5px; margin-bottom:5px; text-decoration:none; color:#333;">üìÑ {{ pdf.name }}</a>
        {% endfor %}
        {% endif %}
    </div>

    <div class="footer">Pay4You Card Copyright 2026 Giuseppe Di Lisio</div>

    <div id="qrModal" class="modal-overlay">
        <div class="modal-box">
            <h3>Condividi Card</h3>
            <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://pay4you-cards-fire.onrender.com/card/{{ ag.slug }}" style="margin-bottom:15px;">
            <a href="mailto:?subject=La mia Card&body=Ecco il mio biglietto: https://pay4you-cards-fire.onrender.com/card/{{ ag.slug }}" class="modal-btn btn-em">üìß Invia Email</a>
            <a href="https://wa.me/?text=Ecco la mia card: https://pay4you-cards-fire.onrender.com/card/{{ ag.slug }}" class="modal-btn btn-wa">üí¨ Invia WhatsApp</a>
            <button onclick="document.getElementById('qrModal').style.display='none'" class="modal-btn btn-close">CHIUDI</button>
        </div>
    </div>
    
    <div id="imgModal" class="modal-overlay" onclick="this.style.display='none'">
        <img id="bigImg" style="max-width:90%; max-height:80vh; border-radius:10px;">
    </div>

  </div>

  <script>
    function openQrModal() { document.getElementById('qrModal').style.display = 'flex'; }
    function openImg(src) { 
        document.getElementById('bigImg').src = src; 
        document.getElementById('imgModal').style.display = 'flex'; 
    }
    function setTheme(t) {
        if(t==='auto') document.body.removeAttribute('data-theme');
        else document.body.setAttribute('data-theme', t);
    }
  </script>
</body>
</html>
