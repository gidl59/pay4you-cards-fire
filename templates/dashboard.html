<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | Pay4You</title>
    <link rel="stylesheet" href="/static/style.css">
    <script>
        function openModal(type, src, id) {
            document.getElementById('modalOverlay').style.display = 'flex';
            document.getElementById('modalImage').src = src;
            // Qui potresti settare l'ID per l'eliminazione
        }
        function closeModal() {
            document.getElementById('modalOverlay').style.display = 'none';
        }
        function deleteItem() {
            if(confirm("Sei sicuro di voler eliminare questo elemento?")) {
                if(confirm("Conferma definitiva: L'operazione Ã¨ irreversibile.")) {
                    alert("Elemento eliminato!");
                    closeModal();
                }
            }
        }
    </script>
</head>
<body class="dash-body">

    <header class="dash-header">
        <div class="user-pill">
            <img src="/static/pay4you-logo.png" class="logo-p1-small" alt="Logo P1">
            <div style="line-height:1.2;">
                <strong style="display:block; color:white;">{{ user.nome }}</strong>
                <small style="color:var(--brand-primary);">@{{ user.username }}</small>
            </div>
        </div>
        <a href="/area/logout" style="color:#ff4444; font-weight:bold;">Esci</a>
    </header>

    <div class="dash-container">
        
        {% for p_id in ['1', '2', '3'] %}
        {% set p = user['p'~p_id] %}
        
        <div class="profile-strip {{ 'active' if p.active else 'inactive' }}">
            
            <div class="strip-info">
                <img src="{{ p.foto }}" class="agent-photo" onerror="this.src='https://via.placeholder.com/70?text=Agente'">
                <div class="info-text">
                    <h3>{{ p.name }}</h3>
                    <p>Slug: <strong>{{ user.username }}</strong> â€¢ Profilo P{{ p_id }}</p>
                </div>
            </div>

            <div class="strip-actions">
                <a href="#" target="_blank" class="btn-dash btn-main">ğŸ”— APRI P{{p_id}}</a>
                <button class="btn-dash" onclick="openModal('qr', 'https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=Example', '{{p_id}}')">ğŸ“± QR{{p_id}}</button>
                <button class="btn-dash">ğŸ“‡ VCF</button>
                <button class="btn-dash btn-main">âœï¸ MODIFICA P{{p_id}}</button>

                {% if p_id == '1' %}
                    <button class="btn-dash btn-creds" onclick="alert('Credenziali inviate al cliente!')">ğŸ“§ INVIA CREDENZIALI</button>
                {% else %}
                    <button class="btn-dash btn-del">âœ• DISATTIVA</button>
                {% endif %}
            </div>

            <div class="media-row">
                <div class="media-thumb" onclick="openModal('img', '/static/uploads/foto1.jpg', '{{p_id}}')">ğŸ“·</div>
                <div class="media-thumb" onclick="openModal('img', '/static/uploads/foto2.jpg', '{{p_id}}')">ğŸ“·</div>
                <div class="media-thumb" style="border-color:#0088cc; color:#0088cc;" onclick="alert('Apre Video Player')">ğŸ¥</div>
                <div class="media-thumb" style="border-color:#ff4444; color:#ff4444;" onclick="openModal('pdf', '', '{{p_id}}')">ğŸ“„ PDF</div>
            </div>

        </div>
        {% endfor %}

    </div>

    <div id="modalOverlay" class="modal-overlay">
        <div class="modal-content">
            <h3 style="color:var(--brand-primary); margin-top:0;">Anteprima</h3>
            <img id="modalImage" src="" class="modal-img">
            
            <div class="modal-actions">
                <button class="btn-modal btn-mail" onclick="alert('Invio per Email...')">âœ‰ï¸ Invia Email</button>
                <button class="btn-modal btn-wa" onclick="alert('Invio su WhatsApp...')">ğŸ’¬ Invia WhatsApp</button>
                <button class="btn-modal btn-del" style="border:1px solid red; background:transparent; color:red;" onclick="deleteItem()">ğŸ—‘ï¸ Elimina</button>
                <button class="btn-modal btn-close" onclick="closeModal()">Chiudi</button>
            </div>
        </div>
    </div>

</body>
</html>
