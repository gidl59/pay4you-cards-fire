{% extends "base.html" %}
{% block title %}Codici cliente | Pay4You{% endblock %}

{% block content %}
<div class="page-main">
  <div class="panel" style="width:min(900px,100%);">
    <div class="panel-head">
      <h1 class="page-title" style="margin:0;">Codici cliente</h1>
      <div class="hint" style="margin-top:6px;">
        Usa questi dati per inviare al cliente link + username + password (poi lo automatizziamo con WhatsApp/Stripe).
      </div>
    </div>

    <div style="padding:18px;">
      <div class="row" style="justify-content:flex-start; gap:12px;">
        <span style="min-width:160px;">Cliente</span>
        <strong>{{ agent.name }}</strong>
      </div>

      <div class="row">
        <span>Link accesso</span>
        <span style="display:flex; gap:10px; align-items:center;">
          <code>{{ activate_url }}</code>
          <button class="btn-mini" type="button" onclick="copyText('{{ activate_url }}')">Copia</button>
        </span>
      </div>

      <div class="row">
        <span>Username</span>
        <span style="display:flex; gap:10px; align-items:center;">
          <code>{{ username }}</code>
          <button class="btn-mini" type="button" onclick="copyText('{{ username }}')">Copia</button>
        </span>
      </div>

      <div class="row">
        <span>Password</span>
        <span style="display:flex; gap:10px; align-items:center;">
          <code>{{ password }}</code>
          <button class="btn-mini" type="button" onclick="copyText('{{ password }}')">Copia</button>
        </span>
      </div>

      <div class="row">
        <span>Link card</span>
        <span style="display:flex; gap:10px; align-items:center;">
          <code>{{ card_url }}</code>
          <button class="btn-mini" type="button" onclick="copyText('{{ card_url }}')">Copia</button>
        </span>
      </div>

      <div class="hint" style="margin-top:14px;">
        Testo suggerito da incollare al cliente:
        <div class="codebox" id="msgBox" style="margin-top:8px;">
Ciao {{ agent.name }},
ecco le credenziali per gestire la tua Pay4You Card:

Link accesso: {{ activate_url }}
Username: {{ username }}
Password: {{ password }}

Al primo accesso salva le credenziali in un posto sicuro.
        </div>
        <button class="btn primary" type="button" style="margin-top:10px;" onclick="copyMsg()">Copia messaggio</button>
      </div>

      <div style="margin-top:18px;">
        <a class="btn ghost" href="{{ url_for('dashboard') }}">Torna alla lista</a>
      </div>
    </div>
  </div>
</div>

<script>
  function copyText(text){
    navigator.clipboard.writeText(text).then(()=>{
      alert('Copiato!');
    });
  }
  function copyMsg(){
    const t = document.getElementById('msgBox').innerText;
    copyText(t);
  }
</script>
{% endblock %}
