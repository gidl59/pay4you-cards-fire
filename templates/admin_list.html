{% extends "base.html" %}
{% block title %}Admin – Lista Card{% endblock %}

{% block content %}
<div class="page-main">
  <div class="admin-wrapper">
    <h1 class="admin-title">Admin – Lista Card</h1>

    <div class="admin-top-actions">
      <a class="admin-new-link" href="{{ url_for('new_agent') }}">➕ Nuova card</a>
    </div>

    <div class="admin-list">
      {% for a in agents %}
        <div class="admin-card">
          <div class="admin-card-head">
            <div class="admin-card-title">
              <b>{{ a.name }}</b>
              <div class="admin-card-sub">Slug: <code>{{ a.slug }}</code> — Piano: <b>{{ a.plan }}</b></div>
            </div>

            <div class="admin-card-links">
              <a class="mini-btn" href="/{{ a.slug }}" target="_blank" rel="noopener">Apri</a>
              <a class="mini-btn" href="{{ url_for('edit_agent', slug=a.slug) }}">Modifica</a>

              <!-- ✅ export “per riga”: scarica JSON completo ma da qui -->
              <a class="mini-btn" href="{{ url_for('admin_export_agents_json') }}">Export JSON</a>
            </div>
          </div>

          <div class="admin-card-actions">
            <form method="post" action="{{ url_for('delete_agent', slug=a.slug) }}" onsubmit="return confirm('Eliminare questa card?');">
              <button type="submit" class="mini-btn danger">Elimina</button>
            </form>
          </div>
        </div>
      {% endfor %}
    </div>

  </div>
</div>
{% endblock %}
