{% extends "base.html" %}
{% block title %}Admin | Pay4You{% endblock %}

{% block content %}
<div class="page-main">
  <div class="agent-form-wrapper">
    <h1 class="agent-form-title">Admin – Lista Card</h1>

    <div style="display:flex; gap:10px; flex-wrap:wrap; margin-bottom:12px;">
      <a class="header-link primary" href="{{ url_for('new_agent') }}">➕ Nuova card</a>
      <a class="header-link" href="{{ url_for('admin_export_agents_json') }}">⬇️ Export JSON</a>
    </div>

    <div class="table-wrap">
      <table class="table">
        <thead>
          <tr>
            <th>Nome</th>
            <th>Slug</th>
            <th>Azioni</th>
          </tr>
        </thead>
        <tbody>
          {% for a in agents %}
          <tr>
            <td>{{ a.name }}</td>
            <td style="opacity:.85;">{{ a.slug }}</td>
            <td>
              <div class="actions">
                <a class="action-pill primary" href="/{{ a.slug }}" target="_blank" rel="noopener">Apri Card</a>
                <a class="action-pill" href="/{{ a.slug }}?p=p2" target="_blank" rel="noopener">Apri P2</a>
                <a class="action-pill" href="{{ url_for('edit_agent', slug=a.slug) }}">Modifica</a>

                <form method="post"
                      action="{{ url_for('delete_agent', slug=a.slug) }}"
                      onsubmit="return confirm('Eliminare questa card?')"
                      style="display:inline;">
                  <button class="action-pill danger" type="submit">Elimina</button>
                </form>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="subtle" style="margin-top:12px;">
      Suggerimento: apri la card in una nuova scheda per verificare foto, logo, video e PDF.
    </div>

  </div>
</div>
{% endblock %}
