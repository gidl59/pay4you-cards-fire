{% extends "base.html" %}

{% block title %}
  {% if agent %}Modifica agente{% else %}Nuovo agente{% endif %}
{% endblock %}

{% block content %}
<div class="admin-wrapper">
  <div class="admin-card agent-form-wrapper">
    <h1 class="agent-form-title">
      {% if agent %}Modifica agente{% else %}Nuovo agente{% endif %}
    </h1>

    <form class="agent-form"
          method="post"
          enctype="multipart/form-data"
          action="{% if agent %}{{ url_for('update_agent', slug=agent.slug) }}{% else %}{{ url_for('create_agent') }}{% endif %}">

      <!-- Slug -->
      <div>
        <label for="slug">Slug (URL) <small>es. <code>giuseppe</code> → /giuseppe</small></label>
        <input type="text"
               id="slug"
               name="slug"
               value="{{ agent.slug if agent else '' }}"
               required>
      </div>

      <!-- Nome completo -->
      <div>
        <label for="name">Nome completo</label>
        <input type="text"
               id="name"
               name="name"
               value="{{ agent.name if agent else '' }}"
               required>
      </div>

      <!-- Azienda -->
      <div>
        <label for="company">Azienda</label>
        <input type="text"
               id="company"
               name="company"
               value="{{ agent.company if agent else 'Pay4You' }}">
      </div>

      <!-- Ruolo -->
      <div>
        <label for="role">Ruolo (facoltativo)</label>
        <input type="text"
               id="role"
               name="role"
               value="{{ agent.role if agent else '' }}">
      </div>

      <!-- Bio -->
      <div>
        <label for="bio">Bio / descrizione breve</label>
        <textarea id="bio" name="bio">{% if agent and agent.bio %}{{ agent.bio }}{% endif %}</textarea>
      </div>

      <!-- TELEFONI -->
      <div>
        <label for="phone_mobile">Telefono mobile</label>
        <input type="text"
               id="phone_mobile"
               name="phone_mobile"
               value="{{ agent.phone_mobile if agent else '' }}">
      </div>

      <div>
        <label for="phone_office">Telefono ufficio</label>
        <input type="text"
               id="phone_office"
               name="phone_office"
               value="{{ agent.phone_office if agent else '' }}">
      </div>

      <!-- EMAIL / SITI -->
      <div>
        <label for="emails">Email (separate da virgola)</label>
        <input type="text"
               id="emails"
               name="emails"
               value="{{ agent.emails if agent else '' }}">
      </div>

      <div>
        <label for="websites">Siti web (separati da virgola)</label>
        <input type="text"
               id="websites"
               name="websites"
               value="{{ agent.websites if agent else '' }}">
      </div>

      <!-- WHATSAPP & SOCIAL -->
      <div>
        <label for="whatsapp">WhatsApp (numero internazionale)</label>
        <input type="text"
               id="whatsapp"
               name="whatsapp"
               value="{{ agent.whatsapp if agent else '' }}">
      </div>

      <div>
        <label for="facebook">Facebook</label>
        <input type="text"
               id="facebook"
               name="facebook"
               value="{{ agent.facebook if agent else '' }}">
      </div>

      <div>
        <label for="instagram">Instagram</label>
        <input type="text"
               id="instagram"
               name="instagram"
               value="{{ agent.instagram if agent else '' }}">
      </div>

      <div>
        <label for="linkedin">LinkedIn</label>
        <input type="text"
               id="linkedin"
               name="linkedin"
               value="{{ agent.linkedin if agent else '' }}">
      </div>

      <!-- PEC / P.IVA / SDI -->
      <div>
        <label for="pec">PEC</label>
        <input type="text"
               id="pec"
               name="pec"
               value="{{ agent.pec if agent else '' }}">
      </div>

      <div>
        <label for="piva">Partita IVA</label>
        <input type="text"
               id="piva"
               name="piva"
               value="{{ agent.piva if agent else '' }}">
      </div>

      <div>
        <label for="sdi">Codice SDI</label>
        <input type="text"
               id="sdi"
               name="sdi"
               value="{{ agent.sdi if agent else '' }}">
      </div>

      <!-- INDIRIZZI -->
      <div>
        <label for="addresses">Indirizzi (uno per riga)</label>
        <textarea id="addresses" name="addresses">{% if agent and agent.addresses %}{{ agent.addresses }}{% endif %}</textarea>
      </div>

      <!-- FOTO PROFILO -->
      <div>
        <label for="photo">Foto profilo</label>
        <input type="file"
               id="photo"
               name="photo"
               accept="image/*">
        {% if agent and agent.photo_url %}
          <small>Foto già presente. Carica un file solo se vuoi sostituirla.</small>
        {% endif %}
      </div>

      <!-- PDF 1–6 -->
      <div>
        <label>PDF (max 6 documenti)</label>
        <input type="file" name="pdf1" accept="application/pdf">
        <input type="file" name="pdf2" accept="application/pdf">
        <input type="file" name="pdf3" accept="application/pdf">
        <input type="file" name="pdf4" accept="application/pdf">
        <input type="file" name="pdf5" accept="application/pdf">
        <input type="file" name="pdf6" accept="application/pdf">
        {% if agent and agent.pdf1_url %}
          <small>Documenti già presenti. Carica nuovi PDF solo se vuoi sostituirli.</small>
        {% endif %}
      </div>

      <!-- GALLERIA -->
      <div>
        <label for="gallery">Galleria foto (max 12 immagini)</label>
        <input type="file"
               id="gallery"
               name="gallery"
               accept="image/*"
               multiple>
        {% if agent and agent.gallery_urls %}
          <small>Galleria già presente. Carica nuove immagini solo se vuoi sostituirla.</small>
        {% endif %}
      </div>

      <!-- BOTTONI -->
      <div class="agent-form-buttons">
        <button type="submit">Salva modifiche</button>
        <a href="{{ url_for('admin_home') }}" class="btn-secondary">Annulla</a>
      </div>

    </form>
  </div>
</div>
{% endblock %}
